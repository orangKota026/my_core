import{i as M,m as y,c as l,g as A,q as D,l as N,h as V,k as j,d as E,r as $,aP as x,aN as b,a9 as I,aa as m,aV as G,f as i,ad as d,bd as B,be as k,ai as z,a5 as R,ag as T,aM as U,aR as P,ab as w,aT as g,ae as v,ah as q,F as K}from"./index.e6b5a79b.js";import{Q as L}from"./QForm.6b065f9e.js";import{b as S}from"./api.0b05746d.js";const X={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function Y(){const{props:e,proxy:{$q:t}}=A(),a=M(D,y);if(a===y)return console.error("QPageSticky needs to be child of QLayout"),y;const s=l(()=>{const o=e.position;return{top:o.indexOf("top")!==-1,right:o.indexOf("right")!==-1,bottom:o.indexOf("bottom")!==-1,left:o.indexOf("left")!==-1,vertical:o==="top"||o==="bottom",horizontal:o==="left"||o==="right"}}),r=l(()=>a.header.offset),f=l(()=>a.right.offset),n=l(()=>a.footer.offset),h=l(()=>a.left.offset),Q=l(()=>{let o=0,u=0;const c=s.value,C=t.lang.rtl===!0?-1:1;c.top===!0&&r.value!==0?u=`${r.value}px`:c.bottom===!0&&n.value!==0&&(u=`${-n.value}px`),c.left===!0&&h.value!==0?o=`${C*h.value}px`:c.right===!0&&f.value!==0&&(o=`${-C*f.value}px`);const p={transform:`translate(${o}, ${u})`};return e.offset&&(p.margin=`${e.offset[1]}px ${e.offset[0]}px`),c.vertical===!0?(h.value!==0&&(p[t.lang.rtl===!0?"right":"left"]=`${h.value}px`),f.value!==0&&(p[t.lang.rtl===!0?"left":"right"]=`${f.value}px`)):c.horizontal===!0&&(r.value!==0&&(p.top=`${r.value}px`),n.value!==0&&(p.bottom=`${n.value}px`)),p}),O=l(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function F(o){const u=N(o.default);return V("div",{class:O.value,style:Q.value},e.expand===!0?u:[V("div",u)])}return{$layout:a,getStickyContent:F}}var H=j({name:"QPageSticky",props:X,setup(e,{slots:t}){const{getStickyContent:a}=Y();return()=>a(t)}});const J=E({name:"FormPage",props:{endpoint:{type:String,required:!0},modelValue:{type:Object,default:$({}),required:!0},titleValue:{type:String,default:"Default",required:!0},iconValue:{type:String,default:"info",required:!0},editValue:{type:Boolean,default:!0,required:!0}},setup(e){return{data:e.modelValue,title:$(e.titleValue),editMod:$(e.editValue)}},watch:{"$route.params":function(e){e&&window.location.reload()}},async mounted(){var e,t;if(((e=this.$route.params)==null?void 0:e.id)==="new")this.title="Tambah "+this.title;else{const{data:a}=await S.get(this.endpoint+"/"+((t=this.$route.params)==null?void 0:t.id));a&&(this.title="Edit "+this.title,this.editMod=!1,Object.entries(a).forEach(([s,r])=>{Object.prototype.hasOwnProperty.call(a,s)&&(this.data[s]=s==="isActive"?String(r):r)}))}},methods:{async acationBtn(e,t){x.create({title:"Information",message:`Are you sure you this ${e} ?`,ok:{label:"yes",color:"positive"},cancel:{label:"no",color:"negative"}}).onOk(async()=>{switch(e){case"edit":this.editMod=!0;break;case"save":if(await this.onAction())try{const{status:s}=await S.post(this.endpoint+"/",t);(s===200||s===201)&&this.isSussess(e)}catch{b.create({message:`User Gagal Di ${e}`,color:"negative",progress:!0,timeout:1e3})}break;case"update":if(await this.onAction())try{const{status:s}=await S.patch(this.endpoint+"/"+(t==null?void 0:t.id),t);(s===200||s===201)&&this.isSussess(e)}catch{b.create({message:`User Gagal Di ${e}`,color:"negative",progress:!0,timeout:1e3})}break;case"close":this.$router.push(this.$route.matched[0].path+"/"+this.endpoint);break;default:b.create({message:`Aksi '${e}' tidak diketahui`,color:"negative",progress:!0,timeout:1e3});break}}).onCancel(()=>!1)},isSussess(e){const t=`Data ${this.title} ${e} successfully`;switch(e){case"save":case"update":case"hapus":return x.create({title:"Success",message:t,persistent:!0}).onOk(()=>this.$router.push(this.$route.matched[0].path+"/"+this.endpoint));default:this.$router.go(-1);break}},async onAction(){const e=this.$refs.form.getValidationComponents();for(const t of e)if(t.rules&&!t.modelValue)return this.$q.notify({progress:!0,timeout:1e3,type:"negative",message:`${t.name||t.label} is required!`}),t.$el.querySelector("input, textarea, select").focus(),this.$refs.form.validate();return!0}}}),W={class:"text-center text-weight-bold text-h6"},Z={class:"q-mx-xs text-h6"};function _(e,t,a,s,r,f){return m(),G(K,null,[i(L,{ref:"form"},{default:d(()=>[i(B,{flat:"",bordered:"",class:"bg-white q-pa-md q-mt-xs border-radius-md"},{default:d(()=>[i(k,null,{default:d(()=>[z("div",W,[i(R,{name:e.iconValue,style:{"margin-top":"-5px"}},null,8,["name"]),z("span",Z,T(e.title),1)])]),_:1}),i(U),i(k,{class:"q-mx-xs"},{default:d(()=>[P(e.$slots,"body",{model:e.data,edit:e.editMod},void 0,!0)]),_:3})]),_:3})]),_:3},512),i(H,{expand:"",position:"top"},{default:d(()=>[i(B,{flat:"",bordered:"",class:"nav-bar full-width bg-white shadow-1"},{default:d(()=>[i(k,{class:"btn-action q-gutter-md",align:"left"},{default:d(()=>[e.data.id&&!e.editMod?(m(),w(v,{key:0,dense:"",size:"md",icon:"edit",color:"positive",label:e.$q.screen.width<599?"":"Edit",style:g(e.$q.screen.width<599?"":"width: 120px; font-size: 0.8rem"),onClick:t[0]||(t[0]=n=>e.acationBtn("edit",e.data))},null,8,["label","style"])):q("",!0),!e.data.id&&e.editMod?(m(),w(v,{key:1,dense:"",size:"md",icon:"add",color:"positive",label:e.$q.screen.width<599?"":"Save",style:g(e.$q.screen.width<599?"":"width: 120px; font-size: 0.8rem"),onClick:t[1]||(t[1]=n=>e.acationBtn("save",e.data))},null,8,["label","style"])):q("",!0),e.data.id&&e.editMod?(m(),w(v,{key:2,dense:"",size:"md",icon:"save",color:"primary",label:e.$q.screen.width<599?"":"update",style:g(e.$q.screen.width<599?"":"width: 120px; font-size: 0.8rem"),onClick:t[2]||(t[2]=n=>e.acationBtn("update",e.data))},null,8,["label","style"])):q("",!0),i(v,{dense:"",size:"md",icon:"close",color:"negative",label:e.$q.screen.width<599?"":"Close",style:g(e.$q.screen.width<599?"":"width: 120px; font-size: 0.8rem"),onClick:t[3]||(t[3]=n=>e.acationBtn("close",e.data))},null,8,["label","style"]),P(e.$slots,"action",{model:e.data},void 0,!0)]),_:3})]),_:3})]),_:3})],64)}var se=I(J,[["render",_],["__scopeId","data-v-cfca9970"]]);export{se as F};
