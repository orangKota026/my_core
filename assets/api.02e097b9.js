import{a as p}from"./axios.f7d2ff76.js";import{k as h,b5 as g,b6 as d,h as f,a9 as v,b7 as l,aY as y}from"./index.8ac86a6c.js";const k='<g><path fill="none" stroke="currentColor" stroke-width="5" stroke-miterlimit="10" d="M58.4,51.7c-0.9-0.9-1.4-2-1.4-2.3s0.5-0.4,1.4-1.4 C70.8,43.8,79.8,30.5,80,15.5H70H30H20c0.2,15,9.2,28.1,21.6,32.3c0.9,0.9,1.4,1.2,1.4,1.5s-0.5,1.6-1.4,2.5 C29.2,56.1,20.2,69.5,20,85.5h10h40h10C79.8,69.5,70.8,55.9,58.4,51.7z"></path><clipPath id="uil-hourglass-clip1"><rect x="15" y="20" width="70" height="25"><animate attributeName="height" from="25" to="0" dur="1s" repeatCount="indefinite" values="25;0;0" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="20" to="45" dur="1s" repeatCount="indefinite" values="20;45;45" keyTimes="0;0.5;1"></animate></rect></clipPath><clipPath id="uil-hourglass-clip2"><rect x="15" y="55" width="70" height="25"><animate attributeName="height" from="0" to="25" dur="1s" repeatCount="indefinite" values="0;25;25" keyTimes="0;0.5;1"></animate><animate attributeName="y" from="80" to="55" dur="1s" repeatCount="indefinite" values="80;55;55" keyTimes="0;0.5;1"></animate></rect></clipPath><path d="M29,23c3.1,11.4,11.3,19.5,21,19.5S67.9,34.4,71,23H29z" clip-path="url(#uil-hourglass-clip1)" fill="currentColor"></path><path d="M71.6,78c-3-11.6-11.5-20-21.5-20s-18.5,8.4-21.5,20H71.6z" clip-path="url(#uil-hourglass-clip2)" fill="currentColor"></path><animateTransform attributeName="transform" type="rotate" from="0 50 50" to="180 50 50" repeatCount="indefinite" dur="1s" values="0 50 50;0 50 50;180 50 50" keyTimes="0;0.7;1"></animateTransform></g>';var C=h({name:"QSpinnerHourglass",props:g,setup(e){const{cSize:i,classes:r}=d(e);return()=>f("svg",{class:r.value,width:i.value,height:i.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg",innerHTML:k})}});const a=p.create({baseURL:"https://mycore.web.id"});a.defaults.loading=!0;a.defaults.errorHandler=!0;const w=()=>{l.show({spinner:C,spinnerColor:"white",spinnerSize:100,backgroundColor:"blue-grey-10",message:"Some important process is in progress. Hang on...",messageColor:"white"})},u=()=>{l.hide()},c=async e=>{var i,r,o;if((i=e.config)!=null&&i.loading&&u(),(r=e.config)!=null&&r.errorHandler){let s=e.message;const t=(o=e.response)==null?void 0:o.data;if(t&&typeof t=="object"){if(t.statusCode===401&&t.message==="Token Expired"){if(!e.config.refreshToken){const n=localStorage.getItem("refresh_token");if(n)return e.config.refreshToken=!0,e.config.method="get",e.config.url=`auth/refresh/${n}`,a.request(e.config)}logout();return}s="",t!=null&&t.error&&(s+=`<div class="text-bold">${t.error}</div>`),t!=null&&t.message&&(Array.isArray(t.message)?s+=t.message.map(n=>`<li>${n}</li>`).join(""):s+=`<div class="text-caption text-white">${t==null?void 0:t.message}</div>`)}y.create({type:"negative",position:"top-right",message:s||e.message,html:!0})}return Promise.reject(e)},b=()=>({authorization:"Bearer "+m()||null}),m=()=>localStorage.getItem("access_token");a.interceptors.request.use(e=>{if(e.url.includes("/auth/login"))return e;if(m())return e.loading&&w(),e.headers={...e.headers,...b()},e;v.logout()},c);a.interceptors.response.use(e=>{var i;return(i=e.config)!=null&&i.loading&&u(),e},c);export{a};
